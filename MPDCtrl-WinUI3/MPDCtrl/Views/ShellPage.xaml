<Page
    x:Class="MPDCtrl.Views.ShellPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals" 
    xmlns:vm="using:MPDCtrl.ViewModels"
    xmlns:mod="using:MPDCtrl.Models" 
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
    NavigationCacheMode="Required"
    mc:Ignorable="d"
    Loaded="Page_Loaded"
    PreviewKeyDown="Page_PreviewKeyDown" PreviewKeyUp="Page_PreviewKeyUp">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="42"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="1"/>
            <RowDefinition Height="116"/>
        </Grid.RowDefinitions>

        <!-- App dummy titlebar -->
        <Grid Grid.Row="0" Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="48"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <!-- NavigationView.PaneToggleButton: None draggable area(48px). Exclude from TitleBar -->
                <Button x:Name="DummyButton" Height="36" Width="40" Margin="3,6,0,0" Visibility="Collapsed"/>
            </Grid>
            <Grid x:Name="AppTitleBar" Grid.Column="1">
                <!-- Application TitleBar: SetTitleBar in code behinde -->
            </Grid>
        </Grid>

        <!-- NaviView -->
        <Grid Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" BorderBrush="{ThemeResource SmokeFillColorDefaultBrush}" BorderThickness="0,0,0,0">

            <NavigationView x:Name="NaviView" AccessKey="H" MenuItemsSource="{x:Bind ViewModel.MainMenuItems, Mode=OneWay}" IsTitleBarAutoPaddingEnabled="True" IsBackButtonVisible="Collapsed" IsPaneToggleButtonVisible="False" IsSettingsVisible="True" PaneDisplayMode="Left" ExpandedModeThresholdWidth="1008" CompactModeThresholdWidth="640" OpenPaneLength ="320" IsPaneOpen="{x:Bind ViewModel.IsNavigationViewMenuOpen, Mode=TwoWay}" Loaded="NavigationView_Loaded" ItemInvoked="NavigationView_ItemInvoked" SelectionChanged="NaviView_SelectionChanged">
                <NavigationView.PaneHeader>
                    <!-- App title and icon -->
                    <Grid VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="Auto"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <!-- App icon and app name -->
                        <StackPanel Grid.Column="0" Margin="12,0,0,0" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="/Assets/MPDCtrl.ico" HorizontalAlignment="Left" VerticalAlignment="Center" Width="18" Height="18" Margin="0,0,0,0"/>
                            <TextBlock Text="MPDCtrl" Margin="6,0,0,0" VerticalAlignment="Center" Opacity="0.9" FontSize="12"/>
                        </StackPanel>
                        <!-- Progress ring -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="12,0,12,0">

                            <ProgressRing IsActive="{x:Bind ViewModel.IsWorking, Mode=OneWay}" Width="16" Height="16" HorizontalAlignment="Right" VerticalAlignment="Center" />

                            <Button Command="{x:Bind ViewModel.FireDebugWindowShowHideCommand}" HorizontalAlignment="Right" VerticalAlignment="Center" Background="Transparent" BorderThickness="0" Visibility="{x:Bind ViewModel.IsDebugWindowEnabled, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Viewbox Width="12" Height="12" Margin="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Path Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Data="M20,8H17.19C16.74,7.2 16.12,6.5 15.37,6L17,4.41L15.59,3L13.42,5.17C12.96,5.06 12.5,5 12,5C11.5,5 11.05,5.06 10.59,5.17L8.41,3L7,4.41L8.62,6C7.87,6.5 7.26,7.21 6.81,8H4V10H6.09C6.03,10.33 6,10.66 6,11V12H4V14H6V15C6,15.34 6.03,15.67 6.09,16H4V18H6.81C8.47,20.87 12.14,21.84 15,20.18C15.91,19.66 16.67,18.9 17.19,18H20V16H17.91C17.97,15.67 18,15.34 18,15V14H20V12H18V11C18,10.66 17.97,10.33 17.91,10H20V8M16,15A4,4 0 0,1 12,19A4,4 0 0,1 8,15V11A4,4 0 0,1 12,7A4,4 0 0,1 16,11V15M14,10V12H10V10H14M10,14H14V16H10V14Z" Width="NaN" Height="NaN" Margin="0">
                                    </Path>
                                </Viewbox>
                            </Button>
                        </StackPanel>
                    </Grid>
                </NavigationView.PaneHeader>
                <!-- Menu Items -->
                <NavigationView.MenuItemTemplate>
                    <DataTemplate x:DataType="mod:NodeTree">
                        <NavigationViewItem MenuItemsSource="{x:Bind Children, Mode=OneWay}" IsExpanded="{x:Bind Expanded, Mode=TwoWay}" IsSelected="{x:Bind Selected, Mode=TwoWay}" Tag="{x:Bind Tag, Mode=OneWay}">
                            <NavigationViewItem.Icon>
                                <PathIcon Width="NaN" Height="NaN" Margin="0" Data="{x:Bind PathIcon, Mode=OneWay}"/>
                            </NavigationViewItem.Icon>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0">
                                <TextBlock Text="{x:Bind Name, Mode=OneWay}" Margin="0,0,0,0"></TextBlock>
                            </StackPanel>
                        </NavigationViewItem>
                    </DataTemplate>
                </NavigationView.MenuItemTemplate>

                <Grid Background="{ThemeResource LayerFillColorDefaultBrush}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="42"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" SizeChanged="AppTitleBar_SizeChanged">
                        <Button x:Name="BackButton" x:Uid="GoBackButton" Height="36" Width="40" Margin="3,6,0,0" Click="BackButton_Click" Style="{StaticResource TitleBarBackButtonStyle}" Visibility="{x:Bind ViewModel.IsGoBackButtonVisible, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    </Border>
                    
                    <!-- NavigationView content frame -->
                    <Frame x:Name="NavigationFrame" Grid.Row="1" Navigated="NavigationFrame_Navigated"/>
                </Grid>

            </NavigationView>

        </Grid>

        <!-- InfoBars -->
        <Grid Grid.Row="2">
            <InfoBar Title="{x:Bind ViewModel.InfoBarInfoTitle, Mode=OneWay}" IsOpen="{x:Bind ViewModel.IsShowInfoWindow, Mode=TwoWay}" IsIconVisible="True" IsClosable="True" Severity="Informational" Message="{x:Bind ViewModel.InfoBarInfoMessage, Mode=OneWay}" />
            <InfoBar Title="{x:Bind ViewModel.InfoBarAckTitle, Mode=OneWay}" IsOpen="{x:Bind ViewModel.IsShowAckWindow, Mode=TwoWay}" IsIconVisible="True" IsClosable="True" Severity="Warning" Message="{x:Bind ViewModel.InfoBarAckMessage, Mode=OneWay}" />
            <InfoBar Title="{x:Bind ViewModel.InfoBarErrTitle, Mode=OneWay}" IsOpen="{x:Bind ViewModel.IsShowErrWindow, Mode=TwoWay}" IsIconVisible="True" IsClosable="True" Severity="Error" Message="{x:Bind ViewModel.InfoBarErrMessage, Mode=OneWay}" />
        </Grid>

        <!-- Debug windows -->
        <Grid Grid.Row="3" x:Name="DebugWindow" Height="260" Visibility="{x:Bind ViewModel.IsShowDebugWindow, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"></ColumnDefinition>
                <ColumnDefinition Width="1*"></ColumnDefinition>
            </Grid.ColumnDefinitions>

            <TextBox Grid.Column="0" x:Name="DebugCommandTextBox" AcceptsReturn="True" ScrollViewer.VerticalScrollBarVisibility="Auto" IsReadOnly="False" TextWrapping="NoWrap" VerticalAlignment="Stretch" Margin="6,6,3,6"></TextBox>
            <Button Grid.Column="0" Margin="16" Command="{x:Bind ViewModel.FireDebugCommandClearCommand}" HorizontalAlignment="Right" VerticalAlignment="Top">
                <Viewbox Width="12" Height="12" Margin="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Path Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Data="M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z" Width="NaN" Height="NaN" Margin="0">
                    </Path>
                </Viewbox>
            </Button>
            
            <TextBox Grid.Column="1" x:Name="DebugIdleTextBox" AcceptsReturn="True" ScrollViewer.VerticalScrollBarVisibility="Auto" IsReadOnly="False" TextWrapping="NoWrap" VerticalAlignment="Stretch" Margin="3,6,6,6"></TextBox>
            <Button Grid.Column="1" Margin="16" Command="{x:Bind ViewModel.FireDebugIdleClearCommand}" HorizontalAlignment="Right" VerticalAlignment="Top">
                <Viewbox Width="12" Height="12" Margin="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Path Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Data="M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z" Width="NaN" Height="NaN" Margin="0">
                    </Path>
                </Viewbox>
            </Button>
            
        </Grid>
        
        <Border Grid.Row="4" Opacity="0.1" BorderThickness="0,1,0,0" BorderBrush="{ThemeResource SmokeFillColorDefaultBrush}"></Border>
        
        <!-- Playback control area -->
        <Grid Grid.Row="5" Background="{ThemeResource LayerFillColorAltBrush}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                
                <Grid Grid.Row="0" Grid.Column="0">
                    <TextBlock Text="{x:Bind ViewModel.ElapsedFormatted, Mode=OneWay}" FontSize="12" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="14,0,18,0"></TextBlock>
                </Grid>
                <Border Grid.Row="0" Grid.Column="1" Margin="6,0,6,0">
                    <Slider x:Name="SeekSlider" PointerWheelChanged="SeekSlider_PointerWheelChanged"  Margin="0" Padding="0" AccessKey="T" Minimum="0" Value="{x:Bind Mode=TwoWay,Path=ViewModel.Elapsed,UpdateSourceTrigger=PropertyChanged}" Maximum="{x:Bind Mode=OneWay,Path=ViewModel.Time}"></Slider>
                </Border>
                <Grid Grid.Row="0" Grid.Column="2">
                    <TextBlock Text="{x:Bind ViewModel.TimeFormatted, Mode=OneWay}" FontSize="12" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="18,0,14,0"></TextBlock>
                </Grid>
                
            </Grid>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*"></ColumnDefinition>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition Width="1*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Grid Grid.Row="0" Grid.Column="0" x:Name="AlbumCoverAndSongTitle" Height="82">

                    <Border x:Name="AlbumCoverBackground" CornerRadius="2" Width="70" Height="70" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8,4,0,8" Background="{ThemeResource SmokeFillColorDefaultBrush}" Opacity="0.1">

                        <Path RenderTransformOrigin="0,0" Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Opacity="0.6" Width="48" Height="48" Data="M12 15.5q1.471 0 2.486-1.014Q15.5 13.47 15.5 12t-1.014-2.485T12 8.5T9.515 9.515T8.5 12t1.015 2.486T12 15.5m0-2.5q-.425 0-.712-.288T11 12t.288-.712T12 11t.713.288T13 12t-.288.713T12 13m.003 8q-1.867 0-3.51-.708q-1.643-.709-2.859-1.924t-1.925-2.856T3 12.003t.709-3.51Q4.417 6.85 5.63 5.634t2.857-1.925T11.997 3t3.51.709q1.643.708 2.859 1.922t1.925 2.857t.709 3.509t-.708 3.51t-1.924 2.859t-2.856 1.925t-3.509.709M12 20q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8"/>

                    </Border>
                    <Border x:Name="AlbumCover" CornerRadius="2" Width="70" Height="70" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8,4,0,8">
                        <Image Source="{x:Bind ViewModel.AlbumArtBitmapSource, Mode=OneWay}" Stretch="UniformToFill"></Image>
                    </Border>
                    <Border x:Name="AlbumCoverBorder" CornerRadius="2" Width="70" Height="70" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8,4,0,8" BorderBrush="Gray" BorderThickness="1" Opacity="0.1">

                    </Border>
                    <Button Background="Transparent" HorizontalAlignment="Left" VerticalAlignment="Stretch" BorderThickness="0" MinWidth="78" Margin="4,0,0,4" VerticalContentAlignment="Top">
                        <StackPanel Margin="80,0,0,0" VerticalAlignment="Top">
                            <TextBlock x:Name="CurrentSongTitle" Text="{x:Bind ViewModel.CurrentSongTitle, Mode=OneWay}" FontSize="20" FontWeight="Bold" Opacity="1" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
                            <TextBlock Opacity="0.8" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" x:Name="CurrentSongArtist" Text="{x:Bind ViewModel.CurrentSongArtist, Mode=OneWay}" Visibility="{x:Bind ViewModel.IsCurrentSongArtistNotNull, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"></TextBlock>
                            <TextBlock Opacity="0.5" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" x:Name="CurrentSongAlbum" Text="{x:Bind ViewModel.CurrentSongAlbum, Mode=OneWay}" Visibility="{x:Bind ViewModel.IsCurrentSongAlbumNotNull, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"></TextBlock>
                        </StackPanel>
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem x:Uid="PageMenu_ScrollIntoNowPlaying" Command="{x:Bind ViewModel.ScrollIntoNowPlayingCommand}">
                                    <MenuFlyoutItem.Icon>
                                        <PathIcon Width="NaN" Height="NaN" Margin="0" Data="M5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274Z"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem x:Uid="ListviewItemContextMenu_GoToAlbumPage" Command="{x:Bind ViewModel.CurrentSongToAlbumPageCommand, Mode=OneWay}">
                                    <MenuFlyoutItem.Icon>
                                        <PathIcon Width="NaN" Height="NaN" Margin="0" Data="M12,11A1,1 0 0,0 11,12A1,1 0 0,0 12,13A1,1 0 0,0 13,12A1,1 0 0,0 12,11M12,16.5C9.5,16.5 7.5,14.5 7.5,12C7.5,9.5 9.5,7.5 12,7.5C14.5,7.5 16.5,9.5 16.5,12C16.5,14.5 14.5,16.5 12,16.5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem x:Uid="ListviewItemContextMenu_GoToArtistPage" Command="{x:Bind ViewModel.CurrentSongToArtistPageCommand, Mode=OneWay}">
                                    <MenuFlyoutItem.Icon>
                                        <PathIcon Width="NaN" Height="NaN" Margin="0" Data="M11,4A4,4 0 0,1 15,8A4,4 0 0,1 11,12A4,4 0 0,1 7,8A4,4 0 0,1 11,4M11,6A2,2 0 0,0 9,8A2,2 0 0,0 11,10A2,2 0 0,0 13,8A2,2 0 0,0 11,6M11,13C12.1,13 13.66,13.23 15.11,13.69C14.5,14.07 14,14.6 13.61,15.23C12.79,15.03 11.89,14.9 11,14.9C8.03,14.9 4.9,16.36 4.9,17V18.1H13.04C13.13,18.8 13.38,19.44 13.76,20H3V17C3,14.34 8.33,13 11,13M18.5,10H20L22,10V12H20V17.5A2.5,2.5 0 0,1 17.5,20A2.5,2.5 0 0,1 15,17.5A2.5,2.5 0 0,1 17.5,15C17.86,15 18.19,15.07 18.5,15.21V10Z"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>
                </Grid>

                <Grid Grid.Row="0" Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Row="0" Grid.Column="0" x:Name="PlaybackPrev" ToolTipService.ToolTip="Ctrl+Left" AccessKey="B" Command="{x:Bind ViewModel.PlayPrevCommand}" Width="30" Height="30" CornerRadius="3" Background="Transparent" BorderThickness="0" Margin="18,0,0,0" HorizontalAlignment="Right" VerticalAlignment="Center" Padding="0">
                        <Button.KeyboardAccelerators>
                            <KeyboardAccelerator Key="Left" Modifiers="Control"/>
                        </Button.KeyboardAccelerators>
                        <Path RenderTransformOrigin="0,0" Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Width="18" Height="18" Data="M3 20.25a.75.75 0 0 0 1.5 0V3.75a.75.75 0 1 0-1.5 0v16.5ZM18.23 20.475c1.158.83 2.77.002 2.77-1.422V4.83c0-1.384-1.53-2.22-2.695-1.473l-10.47 6.716a1.75 1.75 0 0 0-.074 2.895l10.47 7.507Zm1.27-1.422a.25.25 0 0 1-.396.203l-10.47-7.507a.25.25 0 0 1 .011-.413l10.47-6.717a.25.25 0 0 1 .385.21v14.224Z"/>
                    </Button>
                    <Button Grid.Row="0" Grid.Column="1" x:Name="PlaybackPlay" ToolTipService.ToolTip="Ctrl+P, (*Space)" AccessKey="P" Command="{x:Bind ViewModel.PlayCommand}" Width="54" Height="54" CornerRadius="27" Background="Transparent" Margin="18,0,18,0" VerticalAlignment="Center" Padding="0">
                        <Path RenderTransformOrigin="0,0" Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Width="48" Height="48" Data="{x:Bind ViewModel.PlayButton, Mode=OneWay}"/>
                        <Button.KeyboardAccelerators>
                            <KeyboardAccelerator Key="P" Modifiers="Control"/>
                            <!-- not good with listview selection's default/built-in keybind.
                            <KeyboardAccelerator Key="Space"/>
                            -->
                        </Button.KeyboardAccelerators>
                    </Button>
                    <Button Grid.Row="0" Grid.Column="2" x:Name="PlaybackNext" ToolTipService.ToolTip="Ctrl+Right" AccessKey="N" Command="{x:Bind ViewModel.PlayNextCommand}" Width="30" Height="30" CornerRadius="3" Background="Transparent" BorderThickness="0" Margin="0,0,18,0" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="0">
                        <Button.KeyboardAccelerators>
                            <KeyboardAccelerator Key="Right" Modifiers="Control"/>
                        </Button.KeyboardAccelerators>
                        <Path RenderTransformOrigin="0,0" Stretch="UniformToFill" Fill="{ThemeResource TextFillColorSecondaryBrush}" Width="18" Height="18" Data="M21 3.75a.75.75 0 0 0-1.5 0v16.5a.75.75 0 0 0 1.5 0V3.75ZM5.77 3.525C4.612 2.695 3 3.523 3 4.947V19.17c0 1.384 1.53 2.22 2.695 1.473l10.47-6.716a1.75 1.75 0 0 0 .074-2.895L5.77 3.525ZM4.5 4.947a.25.25 0 0 1 .396-.203l10.47 7.507a.25.25 0 0 1-.011.413l-10.47 6.717a.25.25 0 0 1-.385-.21V4.946Z"/>
                    </Button>

                </Grid>

                <Grid Grid.Row="0" Grid.Column="2">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        
                        <controls:WrapPanel Orientation="Horizontal" x:Name="PlaybackOptions" HorizontalSpacing="10" VerticalSpacing="6" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,48,0" Padding="12,0,0,4">
                            <ToggleButton Width="26" Height="26" IsChecked="{x:Bind ViewModel.Repeat, Mode=TwoWay}" AccessKey="R" Padding="0">
                                <Viewbox Width="14" Height="14" Margin="-1,-1,0,0">
                                    <PathIcon Width="NaN" Height="NaN" Data="m14.61 2.47-.077-.067a.748.748 0 0 0-.983.067l-.068.078a.755.755 0 0 0 .068.987l1.971 1.977H8.5l-.233.004C4.785 5.639 2 8.51 2 12.036c0 1.69.64 3.23 1.692 4.39l.072.069a.751.751 0 0 0 1.08-1.033l-.2-.231A5.009 5.009 0 0 1 3.5 12.035c0-2.771 2.239-5.018 5-5.018h6.881l-1.832 1.84-.067.078a.755.755 0 0 0 .068.987.748.748 0 0 0 1.06 0l3.182-3.193.067-.078a.755.755 0 0 0-.067-.987L14.61 2.47Zm5.62 5.101a.751.751 0 0 0-1.05 1.066 5.01 5.01 0 0 1 1.32 3.398c0 2.772-2.239 5.019-5 5.019H8.558l1.905-1.911.074-.086a.755.755 0 0 0-.007-.902l-.067-.077-.084-.073a.748.748 0 0 0-.9.006l-.076.067-3.182 3.194-.073.085a.755.755 0 0 0 .006.902l.067.077 3.182 3.194.084.072c.293.22.71.195.976-.073a.755.755 0 0 0 .068-.987l-.068-.077-1.899-1.906H15.5l.233-.004C19.215 18.432 22 15.56 22 12.035a6.513 6.513 0 0 0-1.697-4.395l-.073-.069Z"/>
                                </Viewbox>
                            </ToggleButton>
                            <ToggleButton Width="26" Height="26" IsChecked="{x:Bind ViewModel.Single, Mode=TwoWay}" AccessKey="E" Padding="0">
                                <Viewbox Width="14" Height="14" Margin="-1,-1,0,0">
                                    <PathIcon Width="NaN" Height="NaN" Data="M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,17H14V7H10V9H12"/>
                                </Viewbox>
                            </ToggleButton>
                            <ToggleButton Width="26" Height="26" IsChecked="{x:Bind ViewModel.Random, Mode=TwoWay}" AccessKey="M" Padding="0">
                                <Viewbox Width="14" Height="14" Margin="-1,-3,0,0">
                                    <PathIcon Width="NaN" Height="NaN" Data="M19.2803 4.71967C18.9874 4.42678 18.5126 4.42678 18.2197 4.71967C17.9268 5.01256 17.9268 5.48744 18.2197 5.78033L19.4393 6.99999H19.25C15.332 6.99999 12.8269 9.30232 10.5579 11.3877L10.4925 11.4477C8.15388 13.5968 6.04432 15.5 2.75 15.5C2.33579 15.5 2 15.8358 2 16.25C2 16.6642 2.33579 17 2.75 17C6.66803 17 9.1731 14.6977 11.4421 12.6123L11.4421 12.6123L11.5075 12.5522C13.8461 10.4032 15.9557 8.49999 19.25 8.49999H19.4393L18.2197 9.71966C17.9268 10.0126 17.9268 10.4874 18.2197 10.7803C18.5126 11.0732 18.9874 11.0732 19.2803 10.7803L21.7803 8.28032C21.921 8.13967 22 7.9489 22 7.74999C22 7.55108 21.921 7.36031 21.7803 7.21966L19.2803 4.71967ZM2.75 6.99983C5.99799 6.99983 8.27497 8.58203 10.2514 10.3112C10.1492 10.4048 10.0482 10.4978 9.94821 10.5897L9.81591 10.7113C9.58463 10.9239 9.35843 11.1309 9.13588 11.3316C7.28326 9.73131 5.39993 8.49983 2.75 8.49983C2.33579 8.49983 2 8.16405 2 7.74983C2 7.33562 2.33579 6.99983 2.75 6.99983ZM19.25 16.9998C16.0021 16.9998 13.7251 15.4177 11.7487 13.6885C11.8507 13.5951 11.9515 13.5023 12.0513 13.4105L12.0518 13.4101L12.1841 13.2885C12.4154 13.0759 12.6416 12.8688 12.8642 12.6681C14.7168 14.2684 16.6001 15.4998 19.25 15.4998H19.4393L18.2197 14.2802C17.9268 13.9873 17.9268 13.5124 18.2197 13.2195C18.5126 12.9266 18.9874 12.9266 19.2803 13.2195L21.7803 15.7195C21.921 15.8602 22 16.0509 22 16.2498C22 16.4487 21.921 16.6395 21.7803 16.7802L19.2803 19.2802C18.9874 19.5731 18.5126 19.5731 18.2197 19.2802C17.9268 18.9873 17.9268 18.5124 18.2197 18.2195L19.4393 16.9998H19.25Z"/>
                                </Viewbox>
                            </ToggleButton>
                            <ToggleButton Width="26" Height="26" IsChecked="{x:Bind ViewModel.Consume, Mode=TwoWay}" AccessKey="O" Padding="0">
                                <Viewbox Width="14" Height="14" Margin="-1,-1,0,0">
                                    <PathIcon Width="NaN" Height="NaN" Data="M3 5.5C3.55228 5.5 4 5.05228 4 4.5C4 3.94772 3.55228 3.5 3 3.5C2.44772 3.5 2 3.94772 2 4.5C2 5.05228 2.44772 5.5 3 5.5ZM6 4.5C6 4.22386 6.22386 4 6.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H6.5C6.22386 5 6 4.77614 6 4.5ZM6 9.5C6 9.22386 6.22386 9 6.5 9H17.5C17.7761 9 18 9.22386 18 9.5C18 9.77614 17.7761 10 17.5 10H6.5C6.22386 10 6 9.77614 6 9.5ZM10.0224 15C10.0534 14.6566 10.1159 14.3223 10.207 14H6.5C6.22386 14 6 14.2239 6 14.5C6 14.7761 6.22386 15 6.5 15H10.0224ZM4 14.5C4 15.0523 3.55228 15.5 3 15.5C2.44772 15.5 2 15.0523 2 14.5C2 13.9477 2.44772 13.5 3 13.5C3.55228 13.5 4 13.9477 4 14.5ZM3 10.5C3.55228 10.5 4 10.0523 4 9.5C4 8.94772 3.55228 8.5 3 8.5C2.44772 8.5 2 8.94772 2 9.5C2 10.0523 2.44772 10.5 3 10.5ZM20 15.5C20 17.9853 17.9853 20 15.5 20C13.0147 20 11 17.9853 11 15.5C11 13.0147 13.0147 11 15.5 11C17.9853 11 20 13.0147 20 15.5ZM16.2071 15.5L17.3536 14.3536C17.5488 14.1583 17.5488 13.8417 17.3536 13.6464C17.1583 13.4512 16.8417 13.4512 16.6464 13.6464L15.5 14.7929L14.3536 13.6464C14.1583 13.4512 13.8417 13.4512 13.6464 13.6464C13.4512 13.8417 13.4512 14.1583 13.6464 14.3536L14.7929 15.5L13.6464 16.6464C13.4512 16.8417 13.4512 17.1583 13.6464 17.3536C13.8417 17.5488 14.1583 17.5488 14.3536 17.3536L15.5 16.2071L16.6464 17.3536C16.8417 17.5488 17.1583 17.5488 17.3536 17.3536C17.5488 17.1583 17.5488 16.8417 17.3536 16.6464L16.2071 15.5Z"/>
                                </Viewbox>
                            </ToggleButton>
                        </controls:WrapPanel>

                        <Slider x:Name="VolumeSlider" Orientation="Vertical" PointerWheelChanged="VolumeSlider_PointerWheelChanged"  ToolTipService.ToolTip="Ctrl+Up/Ctrl+Down, Ctrl+Plus/Ctrl+Minus" AccessKey="V" Value="{x:Bind ViewModel.Volume,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Minimum="0" Maximum="100" HorizontalAlignment="Right" Margin="0,10,10,10">
                            <Slider.KeyboardAccelerators>
                                <KeyboardAccelerator Key="Up" Modifiers="Control"/>
                                <KeyboardAccelerator Key="Down" Modifiers="Control"/>
                            </Slider.KeyboardAccelerators>
                        </Slider>

                    </StackPanel>
                </Grid>
            </Grid>

        </Grid>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1800" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="NaviView.IsPaneToggleButtonVisible" Value="True" />
                        <Setter Target="NaviView.PaneDisplayMode" Value="Left" />
                        <Setter Target="NaviView.IsPaneOpen" Value="True" />
                        <Setter Target="NaviView.OpenPaneLength" Value="320" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1008" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="NaviView.IsPaneToggleButtonVisible" Value="True" />
                        <Setter Target="NaviView.PaneDisplayMode" Value="Left" />
                        <Setter Target="NaviView.IsPaneOpen" Value="True" />
                        <Setter Target="NaviView.OpenPaneLength" Value="280" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="NaviView.IsPaneToggleButtonVisible" Value="True" />
                        <Setter Target="NaviView.PaneDisplayMode" Value="CompactLeft" />
                        <Setter Target="NaviView.IsPaneOpen" Value="False" />
                        <Setter Target="PlaybackOptions.Visibility" Value="Visible" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="340" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="NaviView.IsPaneToggleButtonVisible" Value="True" />
                        <Setter Target="NaviView.PaneDisplayMode" Value="CompactLeft" />
                        <Setter Target="NaviView.IsPaneOpen" Value="False" />
                        <Setter Target="PlaybackOptions.Visibility" Value="Collapsed" />
                        <Setter Target="AlbumCoverAndSongTitle.Visibility" Value="Visible" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="NaviView.IsPaneToggleButtonVisible" Value="True" />
                        <Setter Target="NaviView.PaneDisplayMode" Value="CompactLeft" />
                        <Setter Target="NaviView.IsPaneOpen" Value="False" />
                        <Setter Target="AlbumCoverAndSongTitle.Visibility" Value="Collapsed" />
                        <Setter Target="PlaybackOptions.Visibility" Value="Collapsed" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
